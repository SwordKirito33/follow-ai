# Follow.ai Project Rules

## Tech Stack
- React 19 + TypeScript (strict mode enabled)
- Supabase (PostgreSQL + RLS + Edge Functions + Auth)
- Tailwind CSS for styling
- Lucide React for icons
- Framer Motion for animations

## Database Conventions
- Always assume ALL fields can be NULL unless schema explicitly shows NOT NULL
- Check actual table schema before using any field
- Use typeof checks for optional/nullable fields before rendering
- Never render null/undefined directly to UI - use fallbacks

## Component Library Constraints
**Badge Component:**
- ONLY these variants exist: 'success' | 'warning' | 'danger' | 'secondary'
- DO NOT use 'info' or 'primary' variants (they don't exist)

**FollowButton Component:**
- ONLY these variants exist: 'primary' | 'secondary'
- DO NOT use 'destructive' variant (doesn't exist)
- For red buttons: use variant="secondary" + className="bg-red-500 hover:bg-red-600 text-white"

## Supabase Patterns
- Always use supabase.rpc() for database functions
- Always verify JWT tokens in Edge Functions
- Use RLS policies for access control
- Deploy Edge Functions with: npx supabase functions deploy <function-name>
- Project ID: nbvnnhojvkxfnididast

## Error Handling
- Always use try-catch for async operations
- Always use finally blocks for cleanup (especially state resets)
- Show user-friendly error messages via useToast
- Log errors to console for debugging
- Never let the app crash silently

## UI/UX Patterns
- Add loading states for all async operations
- Disable buttons during processing to prevent double-clicks
- Use useToast hook for all notifications
- Format relative timestamps (e.g., "2 hours ago")
- Always add null/undefined fallbacks in JSX:
  - user_level ?? 1
  - username ?? 'unknown'
  - avatar_url ?? default_avatar
  - xp ?? 0

## TypeScript Rules
- Always define proper interfaces for data structures
- Match interface types to actual database nullable fields
- Use `| null` for nullable database columns
- Use `?` for optional properties that may not exist in response

## State Management
- Use useState for component state
- Use useRef for values that shouldn't trigger re-renders (like cancel flags)
- Always clean up state in finally blocks or useEffect cleanup
- Prevent concurrent async operations with loading flags

## Code Style
- Keep functions focused and single-purpose
- Extract magic numbers to constants
- Use descriptive variable names
- Add comments only for complex logic
- Prefer early returns over nested if-else

## DO NOT
- Assume field names without checking actual schema
- Use Badge variants other than success/warning/danger/secondary
- Use FollowButton variants other than primary/secondary
- Render null/undefined directly to UI
- Modify files not explicitly requested
- Add features not specifically asked for
- Over-refactor working code
- Remove error handling or loading states
